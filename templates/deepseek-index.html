<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>EROSA – Seduction, Systemized</title>
    <link rel="icon" type="image/png"
        href="https://cdn.discordapp.com/avatars/1374205097411612682/10be7ba66b741be7783d8abb5e998bd2.webp?size=480">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Inter:wght@400;700&display=swap"
        rel="stylesheet">
    <style>
        :root {
            --primary-gradient: linear-gradient(90deg, #ff4e8e 0%, #e25555 100%);
            --secondary-gradient: linear-gradient(90deg, #ff4e8e 0%, #ff1e56 25%, #fff 50%, #ff1e56 75%, #ff4e8e 100%);
            --accent-color: #ff4e8e;
            --success-color: #27ff60;
            --bg-dark: #18131d;
            --bg-light: #2d1b2e;
        }

        body {
            background: linear-gradient(120deg, var(--bg-dark) 0%, var(--bg-light) 100%);
            color: #fff;
            font-family: 'Inter', 'Montserrat', 'Segoe UI', Arial, sans-serif;
            margin: 0;
            padding: 0;
            min-height: 100vh;
            display: block;
            overflow-x: hidden;
        }

        .bg-glow {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            pointer-events: none;
            z-index: 0;
            background: radial-gradient(circle at 70% 20%, #ff4e8e33 0%, transparent 60%),
                radial-gradient(circle at 20% 80%, #e2555533 0%, transparent 60%);
            animation: bgmove 12s ease-in-out infinite alternate;
        }

        @keyframes bgmove {
            0% {
                background-position: 70% 20%, 20% 80%;
            }
            100% {
                background-position: 60% 30%, 30% 70%;
            }
        }

        /* --- Bubble Spin Animation --- */
        @keyframes bubble-spin {
            0% {
                transform: rotate(0deg) scale(1);
            }
            30% {
                transform: rotate(var(--spin-angle, 12deg)) scale(1.04);
            }
            60% {
                transform: rotate(calc(var(--spin-angle, -10deg) * -1)) scale(1.08);
            }
            100% {
                transform: rotate(360deg) scale(1);
            }
        }

        .bubble-spin {
            animation: bubble-spin var(--spin-speed, 2.5s) linear infinite;
        }

        .main-container {
            background: rgba(30, 18, 38, 0.82);
            border-radius: 2.5rem;
            box-shadow: 0 8px 40px 0 rgba(200, 0, 80, 0.22), 0 1.5px 12px 0 rgba(0, 0, 0, 0.12);
            padding: 3.5rem 2.5rem 2.5rem 2.5rem;
            max-width: 500px;
            width: 95vw;
            text-align: center;
            margin: 2.5rem auto 3.5rem auto;
            z-index: 2;
            backdrop-filter: blur(16px) saturate(160%);
            border: 1.5px solid rgba(255, 78, 142, 0.2);
            animation: fadein 1.2s cubic-bezier(.77, 0, .18, 1) 0.2s both;
            overflow: hidden;
            position: relative;
        }

        @keyframes fadein {
            0% {
                opacity: 0;
                transform: translateY(40px) scale(0.98);
            }
            100% {
                opacity: 1;
                transform: none;
            }
        }

        .wide-logo {
            width: 100%;
            height: auto;
            max-width: 420px;
            min-width: 0;
            max-height: 180px;
            object-fit: contain;
            margin-bottom: 1.2rem;
            margin-top: 0;
            border-radius: 1.5rem;
            display: block;
            margin-left: auto;
            margin-right: auto;
            filter: drop-shadow(0 18px 19px #ff4e8e88);
            background: transparent;
            animation: logoPop 1.2s cubic-bezier(.77, 0, .18, 1) 0.4s both;
        }

        @keyframes logoPop {
            0% {
                opacity: 0;
                transform: scale(0.8) rotate(-6deg);
            }
            80% {
                opacity: 1;
                transform: scale(1.08) rotate(2deg);
            }
            100% {
                opacity: 1;
                transform: scale(1) rotate(0);
            }
        }

        .status-row {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.6em;
            margin-bottom: 1.2em;
        }

        .status-dot {
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--success-color) 0%, #1ed760 100%);
            box-shadow: 0 0 16px 4px rgba(39, 255, 96, 0.8);
            border: 2.5px solid rgba(255, 255, 255, 0.125);
            animation: pulse 1.2s infinite;
        }

        @keyframes pulse {
            0%, 100% {
                box-shadow: 0 0 16px 4px rgba(39, 255, 96, 0.8);
            }
            50% {
                box-shadow: 0 0 32px 10px rgba(39, 255, 96, 0.6);
            }
        }

        .status-label {
            font-size: 1.08rem;
            font-weight: 700;
            color: #b6ffcb;
            letter-spacing: 0.5px;
            text-shadow: 0 1px 8px rgba(30, 215, 96, 0.2);
            text-transform: uppercase;
        }

        h1,
        .tagline {
            font-size: 2.6rem;
            font-weight: 900;
            margin-bottom: 0.15em;
            letter-spacing: 2px;
            font-family: 'Montserrat', 'Inter', 'Segoe UI', Arial, sans-serif;
            font-variation-settings: 'wght' 700, 'ital' 0;
            font-style: italic;
            background: var(--secondary-gradient);
            background-size: 200% 100%;
            background-position: 0 0;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            color: transparent;
            filter: drop-shadow(0 2px 12px rgba(255, 78, 142, 0.27));
            animation: lightning-text 2.2s cubic-bezier(.77, 0, .18, 1) infinite, 
                       fadein 1.2s cubic-bezier(.77, 0, .18, 1) 0.6s both;
            text-shadow: 0 2px 24px rgba(255, 78, 142, 0.2), 0 1px 0 rgba(255, 255, 255, 0.06);
            letter-spacing: 0.08em;
            position: relative;
            overflow: hidden;
        }

        @keyframes lightning-text {
            0% {
                background-position: 0 0;
            }
            40% {
                background-position: 100% 0;
            }
            100% {
                background-position: 200% 0;
            }
        }

        .tagline {
            font-size: 1.35rem;
            font-family: 'Montserrat', 'Inter', 'Segoe UI', Arial, sans-serif;
            font-style: italic;
            font-weight: 600;
            letter-spacing: 0.12em;
            margin-bottom: 0.7em;
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-shadow: 0 2px 12px rgba(255, 78, 142, 0.13), 0 1px 0 rgba(255, 255, 255, 0.06);
            animation: fadein 1.2s cubic-bezier(.77, 0, .18, 1) 0.7s both;
            position: relative;
            overflow: hidden;
        }

        .about {
            font-size: 1.22rem;
            color: #fff;
            margin-bottom: 2.2em;
            line-height: 1.85;
            letter-spacing: 0.25px;
            font-weight: 600;
            text-shadow: 0 2px 18px rgba(255, 78, 142, 0.27), 0 1px 0 rgba(255, 255, 255, 0.125);
            animation: fadein 1.2s cubic-bezier(.77, 0, .18, 1) 0.8s both;
        }

        .features {
            text-align: left;
            margin: 0 auto 2em auto;
            max-width: 340px;
            color: #fff;
            font-size: 1.15rem;
            background: rgba(255, 78, 142, 0.13);
            border-radius: 1.2em;
            padding: 1.2em 1.3em;
            box-shadow: 0 4px 24px 0 rgba(255, 78, 142, 0.13);
            font-weight: 500;
            letter-spacing: 0.18px;
            text-shadow: 0 2px 16px rgba(255, 78, 142, 0.2), 0 1px 0 rgba(255, 255, 255, 0.125);
            animation: fadein 1.2s cubic-bezier(.77, 0, .18, 1) 1s both;
        }

        .features strong {
            color: var(--accent-color);
            font-weight: 800;
            letter-spacing: 0.5px;
        }

        .features-list {
            margin: 0.7em 0 0 0;
            padding: 0;
            list-style: none;
        }

        .features-list li {
            margin-bottom: 0.7em;
            position: relative;
            padding-left: 1.5em;
            font-weight: 600;
            letter-spacing: 0.18px;
            color: #ffe6f7;
            text-shadow: 0 2px 12px rgba(255, 78, 142, 0.2), 0 1px 0 rgba(255, 255, 255, 0.125);
            line-height: 1.6;
        }

        .features-list li::before {
            content: '⟶';
            position: absolute;
            left: 0;
            color: var(--accent-color);
            font-size: 1.1em;
            top: 0.1em;
            filter: drop-shadow(0 1px 4px rgba(255, 78, 142, 0.27));
        }

        .invite-btn {
            background: var(--primary-gradient);
            color: #fff;
            font-weight: 800;
            border: none;
            border-radius: 999px;
            padding: 1rem 2rem;
            font-size: 1.1rem;
            cursor: pointer;
            box-shadow: 0 4px 18px 0 rgba(255, 78, 142, 0.18);
            transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
            display: inline-block;
            text-decoration: none;
        }

        .invite-btn:hover {
            background: linear-gradient(90deg, #e25555 0%, var(--accent-color) 100%);
            transform: translateY(-2px) scale(1.045);
            box-shadow: 0 8px 32px 0 rgba(255, 78, 142, 0.28);
            filter: brightness(1.08) saturate(1.2);
        }

        .footer {
            margin-top: 2.5em;
            font-size: 1.05em;
            color: #b98cb3;
            letter-spacing: 0.7px;
            text-shadow: 0 1px 8px rgba(255, 78, 142, 0.13);
            animation: fadein 1.2s cubic-bezier(.77, 0, .18, 1) 1.4s both;
        }

        .footer .heart {
            color: var(--accent-color);
            animation: heartBeat 1.6s infinite;
        }

        @keyframes heartBeat {
            0%, 100% {
                transform: scale(1);
            }
            10% {
                transform: scale(1.18);
            }
            20% {
                transform: scale(0.92);
            }
            30% {
                transform: scale(1.12);
            }
            40% {
                transform: scale(0.98);
            }
            50% {
                transform: scale(1.08);
            }
            60% {
                transform: scale(1);
            }
        }

        /* === NEW CSS ADDITIONS === */
        /* Progress Bar Styles */
        .bubble-progress-bar {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 10px;
            background: rgba(30, 18, 38, 0.7);
            z-index: 10;
            display: none;
        }

        .bubble-progress-bar-inner {
            height: 100%;
            background: var(--primary-gradient);
            width: 0%;
            transition: width 0.4s ease-out;
            border-radius: 0 4px 4px 0;
        }

        /* Bubble Styles */
        .sexy-bubble {
            position: absolute;
            width: var(--bubble-size);
            height: var(--bubble-size);
            border-radius: 50%;
            background: radial-gradient(circle at 30% 30%, rgba(255, 255, 255, 0.8), rgba(255, 78, 142, 0.4));
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 5;
            box-shadow: 0 0 25px rgba(255, 78, 142, 0.3),
                        inset 0 0 20px rgba(255, 255, 255, 0.4);
            user-select: none;
            animation: bubble-rise var(--duration) linear forwards, 
                       bubble-pulse 1.2s infinite, 
                       bubble-wobble 2.5s ease-in-out infinite;
        }

        .bubble-text {
            font-weight: 700;
            color: rgba(255, 255, 255, 0.9);
            text-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
            font-size: 0.9em;
            text-align: center;
            padding: 10px;
        }

        @keyframes bubble-rise {
            to {
                bottom: var(--rise);
            }
        }

        @keyframes bubble-pulse {
            0%, 100% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.08);
            }
        }

        @keyframes bubble-wobble {
            0%, 100% {
                transform: translateX(0);
            }
            50% {
                transform: translateX(10px);
            }
        }

        /* Firework Styles */
        .firework {
            position: absolute;
            pointer-events: none;
            z-index: 20;
        }

        .fw-part {
            position: absolute;
            width: 6px;
            height: 6px;
            border-radius: 50%;
        }

        /* Moan Word Styles */
        .moan-word {
            position: absolute;
            color: rgba(255, 255, 255, 0.9);
            font-weight: 700;
            font-size: 1.1rem;
            text-shadow: 0 0 10px var(--accent-color);
            z-index: 15;
            opacity: 0;
            transition: opacity 0.3s;
            pointer-events: none;
        }

        .moan-word.show {
            opacity: 1;
        }

        .moan-word.falling {
            animation: fallDown 1.2s forwards;
        }

        @keyframes fallDown {
            to {
                transform: translateY(180px) scale(1.3);
                opacity: 0;
            }
        }

        /* Starfield Enhancements */
        .star {
            position: absolute;
            border-radius: 50%;
            background: linear-gradient(135deg, #fff 60%, var(--accent-color) 100%);
            box-shadow: 0 0 8px 2px rgba(255, 255, 255, 0.5), 0 0 16px 4px rgba(255, 78, 142, 0.2);
            pointer-events: none;
            transition: opacity 0.3s;
        }

        .diagonal-star {
            position: absolute;
            border-radius: 50%;
            box-shadow: 0 0 16px 4px rgba(255, 255, 255, 0.5), 0 0 32px 8px rgba(255, 78, 142, 0.27);
            pointer-events: none;
            z-index: 1;
        }

        .diagonal-star-trail {
            position: absolute;
            border-radius: 50%;
            pointer-events: none;
            z-index: 0;
            filter: blur(1.5px);
        }

        /* Continuous Pulse Animation */
        .pulse-continuous {
            animation: pulse-continuous 1.2s infinite cubic-bezier(.77, 0, .18, 1);
        }

        @keyframes pulse-continuous {
            0%, 100% {
                filter: brightness(1.08) saturate(1.2) drop-shadow(0 0 12px rgba(255, 78, 142, 0.53));
            }
            50% {
                filter: brightness(1.18) saturate(1.4) drop-shadow(0 0 32px var(--accent-color));
            }
        }

        /* Responsive Enhancements */
        @media (max-width: 900px) {
            .main-container {
                max-width: 98vw;
                padding: 1.2rem 0.7rem 1.5rem 0.7rem;
                border-radius: 1.5rem;
                margin: 1.5rem auto 2rem auto;
            }

            .features {
                max-width: 98vw;
                font-size: 1em;
                padding: 1.2em 0.8em;
                border-radius: 1em;
            }

            h1 {
                font-size: 2.2rem;
            }

            .tagline {
                font-size: 1.2rem;
            }
        }

        @media (max-width: 600px) {
            .main-container {
                padding: 1rem;
                border-radius: 1.2rem;
            }

            .features {
                padding: 1em;
            }

            h1 {
                font-size: 1.8rem;
            }

            .tagline {
                font-size: 1.1rem;
            }

            .about {
                font-size: 1rem;
            }
        }
    </style>
</head>

<body>
    <a href="#main-content" class="skip-link">Skip to main content</a>
    <div class="bg-glow" aria-hidden="true"></div>
    <main id="main-content" class="main-container" tabindex="0">
        <!-- Discord Profile Preview -->
        <div class="discord-profile-preview" aria-label="EROSA Discord profile preview">
            <span class="visually-hidden">EROSA Discord profile preview</span>
            <div class="profile-banner">
                <img src="https://cdn.discordapp.com/banners/1374205097411612682/3d2a57d416d3ea267203cd6daecce248.png?size=2048"
                    alt="Discord profile banner for EROSA bot" class="wide-logo" loading="lazy" decoding="async" aria-hidden="true" />
            </div>
            <div class="status-row">
                <span class="status-dot" aria-hidden="true"></span>
                <span class="status-label">Online</span>
            </div>
        </div>
        
        <h1 class="erosa-title">EROSA</h1>
        <div class="tagline">Seduction, Systemized</div>
        
        <div class="about">Built for OnlyFans agencies, chatter teams, and creators who don't just play the game</div>
        <div class="about"><span class="bend-impact">they bend it</span></div>
        <div class="about"><span class="erosa-title-small">EROSA</span> turns every message into momentum, every simp into a systemized transaction.</div>
        
        <section class="features" aria-label="EROSA features">
            <div><strong>Behind its sleek, dripping-heart interface lies a beast:</strong></div>
            <ul class="features-list">
                <li>Track every shift, click, moan, and message.</li>
                <li>Powerful customisations and use cases.</li>
                <li>Lightning-fast, ultra-secure, always online.</li>
                <li>Designed to seduce — built to dominate.</li>
            </ul>
        </section>
        
        <a href="https://discord.com/oauth2/authorize?client_id=1374205097411612682&scope=bot&permissions=8"
            class="invite-btn" aria-label="Invite EROSA bot to your Discord server" rel="noopener noreferrer">
            Invite <span class="erosa-title">EROSA</span> to your Discord
        </a>
        
        <div class="footer" role="contentinfo">
            Made with <span class="heart" aria-hidden="true">❤️</span> by <span class="erosa-title-small">EROSA</span> Team
        </div>
    </main>
    
    <div class="bubble-progress-bar" id="bubbleProgressBar" aria-label="Bubble progress bar">
        <div class="bubble-progress-bar-inner" id="bubbleProgressBarInner"></div>
    </div>
    
    <div class="starfield" aria-hidden="true"></div>
    
    <div id="lowPerfToggleContainer">
        <label>
            <input type="checkbox" id="lowPerfToggle">Low Performance Mode
        </label>
    </div>
    
    <script>
        // === Performance Optimization ===
        // Prevent browser from restoring scroll position
        if ('scrollRestoration' in history) {
            history.scrollRestoration = 'manual';
        }

        // Low Performance Mode Detection & Toggle
        function detectLowPerf() {
            const mem = navigator.deviceMemory || 0;
            const cores = navigator.hardwareConcurrency || 0;
            const ua = navigator.userAgent;
            if (mem && mem <= 2) return true;
            if (cores && cores <= 2) return true;
            if (/Android [1-7]|iPhone OS [1-9]|Mobi|Opera Mini|UCBrowser|KaiOS/i.test(ua)) return true;
            return false;
        }

        function setLowPerfMode(enabled) {
            localStorage.setItem('lowPerfMode', enabled ? '1' : '0');
            window.LOW_PERF_MODE = !!enabled;
            document.getElementById('lowPerfToggle').checked = !!enabled;
            location.reload();
        }

        (function initPerfMode() {
            let stored = localStorage.getItem('lowPerfMode');
            if (stored === null) {
                window.LOW_PERF_MODE = detectLowPerf();
                localStorage.setItem('lowPerfMode', window.LOW_PERF_MODE ? '1' : '0');
            } else {
                window.LOW_PERF_MODE = stored === '1';
            }
            document.addEventListener('DOMContentLoaded', function() {
                const toggle = document.getElementById('lowPerfToggle');
                if (toggle) {
                    toggle.checked = !!window.LOW_PERF_MODE;
                    toggle.addEventListener('change', function() {
                        setLowPerfMode(this.checked);
                    });
                }
            });
        })();

        // === Feature Controller ===
        const Features = (function() {
            // Configuration
            const CONFIG = {
                BUBBLE_WORDS: ["POP ME", "BURST ME", "COME"],
                MOAN_WORDS: ["moan", "mmm", "mhmmm", "baby", "yes", "oh!", "more", "harder", "deeper"],
                FIREWORK_COLORS: ["#ff4e8e", "#e25555", "#fff", "#f7d6e6", "#b6ffcb", "#ffb347", "#b98cb3"],
                MAX_BUBBLES: window.innerWidth < 600 ? 3 : 6,
                POPS_TO_FILL: 12,
                NUM_FIREWORK_PARTS: 28,
                NUM_BURST_MOAN_WORDS: 18,
                STAR_COUNT: 64,
                DIAGONAL_STAR_COLORS: [
                    'rgba(255,255,255,0.95)',
                    'rgba(255,78,142,0.85)',
                    'rgba(182,255,203,0.85)',
                    'rgba(185,140,179,0.85)',
                    'rgba(255,179,71,0.85)'
                ],
                DIAGONAL_TRAIL_LENGTH: 4,
                DIAGONAL_TRAIL_FADE: 0.22,
                DIAGONAL_SPAWN_INTERVAL: 1700,
                DIAGONAL_MAX_STARS: 3
            };

            // State
            let popCount = 0;
            let bubbles = [];
            let barFilled = false;
            let bubbleSpawnTimeout;

            // Utility Functions
            const randomBetween = (a, b) => a + Math.random() * (b - a);
            const pickRandom = arr => arr[Math.floor(Math.random() * arr.length)];
            const requestFrame = window.requestAnimationFrame || 
                                window.webkitRequestAnimationFrame || 
                                window.mozRequestAnimationFrame || 
                                function(cb) { return setTimeout(cb, 16); };

            // === Core Features ===
            function createBubble() {
                const bubble = document.createElement('div');
                bubble.className = 'sexy-bubble bubble-spin';
                bubble.style.setProperty('--spin-angle', pickRandom([12, -12]) + 'deg');
                
                let size = randomBetween(65, 110);
                if (window.innerWidth < 600) size *= 0.8;
                bubble.style.setProperty('--bubble-size', `${size}px`);
                
                bubble.style.left = `${randomBetween(10, 90)}vw`;
                bubble.style.bottom = `-80px`;
                bubble.style.setProperty('--rise', `${randomBetween(60, 90)}vh`);
                
                const duration = randomBetween(6, 10);
                bubble.style.setProperty('--duration', `${duration}s`);
                bubble.style.setProperty('--spin-speed', `${randomBetween(1.5, 3.5)}s`);
                
                document.body.appendChild(bubble);
                bubbles.push(bubble);
                
                setTimeout(() => removeBubble(bubble), duration * 1000 + 500);
                return bubble;
            }

            function removeBubble(bubble) {
                if (bubble && bubble.parentNode) {
                    bubble.parentNode.removeChild(bubble);
                }
                bubbles = bubbles.filter(b => b !== bubble);
            }

            function spawnBubbles() {
                if (document.hidden) {
                    bubbleSpawnTimeout = setTimeout(spawnBubbles, 1000);
                    return;
                }
                
                if (bubbles.length < CONFIG.MAX_BUBBLES) {
                    createBubble();
                }
                
                bubbleSpawnTimeout = setTimeout(spawnBubbles, 400);
            }

            function popBubble(bubble, e) {
                if (!bubble.classList.contains('popped')) {
                    popCount++;
                    updateProgressBar();
                    
                    bubble.classList.add('popped');
                    setTimeout(() => removeBubble(bubble), 400);
                    
                    // Visual effects
                    showMoan(e.clientX, e.clientY);
                    createFirework(e.clientX, e.clientY);
                }
            }

            function createFirework(x, y) {
                const fw = document.createElement('div');
                fw.className = 'firework';
                fw.style.left = `${x}px`;
                fw.style.top = `${y}px`;
                
                for (let i = 0; i < CONFIG.NUM_FIREWORK_PARTS; i++) {
                    const p = document.createElement('span');
                    p.className = 'fw-part';
                    p.style.background = pickRandom(CONFIG.FIREWORK_COLORS);
                    
                    const angle = (i * (360 / CONFIG.NUM_FIREWORK_PARTS)) + randomBetween(-8, 8);
                    const rad = angle * Math.PI / 180;
                    const distance = randomBetween(60, 120);
                    const tx = Math.cos(rad) * distance;
                    const ty = Math.sin(rad) * distance;
                    
                    const anim = p.animate([
                        { transform: 'translate(0, 0) scale(0.2)', opacity: 1 },
                        { transform: `translate(${tx}px, ${ty}px) scale(1.2)`, opacity: 0 }
                    ], {
                        duration: 900,
                        easing: 'cubic-bezier(.77,0,.18,1)',
                        fill: 'forwards',
                    });
                    
                    fw.appendChild(p);
                }
                
                document.body.appendChild(fw);
                setTimeout(() => {
                    if (fw.parentNode) fw.parentNode.removeChild(fw);
                }, 1000);
            }

            function showMoan(x, y) {
                const moan = document.createElement('div');
                moan.className = 'moan-word';
                moan.textContent = pickRandom(CONFIG.MOAN_WORDS);
                moan.style.zIndex = 9999;
                moan.style.left = `${x + randomBetween(-30, 30)}px`;
                moan.style.top = `${y + randomBetween(-30, 30)}px`;
                
                document.body.appendChild(moan);
                moan.classList.add('show');
                
                setTimeout(() => {
                    moan.classList.remove('show');
                    setTimeout(() => {
                        if (moan.parentNode) moan.parentNode.removeChild(moan);
                    }, 300);
                }, 900);
            }

            function updateProgressBar() {
                const bar = document.getElementById('bubbleProgressBar');
                const inner = document.getElementById('bubbleProgressBarInner');
                if (!bar || !inner) return;
                
                bar.style.display = 'flex';
                let percent = Math.min(popCount / CONFIG.POPS_TO_FILL, 1) * 100;
                inner.style.width = percent + '%';
                
                if (percent >= 100 && !barFilled) {
                    barFilled = true;
                    scrollToInviteAndPulse();
                    
                    setTimeout(() => {
                        inner.style.width = '0%';
                        popCount = 0;
                        barFilled = false;
                    }, 1200);
                }
            }

            function scrollToInviteAndPulse() {
                const btn = document.querySelector('.invite-btn');
                if (btn) {
                    btn.scrollIntoView({ 
                        behavior: 'smooth', 
                        block: 'center',
                        inline: 'nearest'
                    });
                    
                    setTimeout(() => {
                        btn.classList.add('pulse-continuous');
                    }, 700);
                }
            }

            // === Initialization ===
            function init() {
                // Event delegation for bubble popping
                document.body.addEventListener('click', function(e) {
                    const bubble = e.target.closest('.sexy-bubble');
                    if (bubble) popBubble(bubble, e);
                });

                // Start bubble spawning
                spawnBubbles();

                // Handle visibility changes
                document.addEventListener('visibilitychange', () => {
                    if (!document.hidden) spawnBubbles();
                    else if (bubbleSpawnTimeout) clearTimeout(bubbleSpawnTimeout);
                });
            }

            // Public API
            return { init };
        })();

        // === Initialize based on performance mode ===
        document.addEventListener('DOMContentLoaded', function() {
            if (!window.LOW_PERF_MODE) {
                Features.init();
            }
        });
    </script>
</body>
</html>